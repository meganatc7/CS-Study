# INDEX

[toc]

> 실제로 컴퓨터끼리는 MAC주소로 통신, but 사람들이 MAC 주소를 이용하긴 어렵기에 IP주소로 통신
>
> IP주소는 3계층에서 사용하는 주소

## 3계층의 기능

### 3계층에서 하는 일

<img src="assets/image-20210930234835598.png" alt="image-20210930234835598" style="zoom:80%;" />

- 3계층은 ==**다른 네트워크 대역**==까지 어떻게 데이터를 전달할지 제어하는 일을 담당
- ==**서로 다른 LAN**==을 연결시켜주는 것
- 발신에서 착신까지의 패킷의 경로를 제어
- router와 같은 3계층 장비 필요



### 3계층에서 쓰는 주소 📌

- ==**MAC 주소**== 뿐만 아니라 ==**IP 주소**==도 가지고 있어야 한다.

<img src="assets/image-20210930235347622.png" alt="image-20210930235347622" style="zoom:80%;" />

- ipconfig를 통해 연결된 IP 주소 확인 가능(뒤에 all을 붙이면 MAC주소까지 같이 확인 가능)
- IP 주소 뿐만 아니라, 서브넷 마스크와 기본 게이트웨이도 필요

<img src="assets/image-20210930235546734.png" alt="image-20210930235546734" style="zoom:80%;" />

- 인터넷 사용시 우리는 IP 주소가 아닌 도메인을 통해 통신 ===> DNS 서버 주소는 도메인을 IP로 바꿔주는 역할



### 3계층 프로토콜

#### ARP 프로토콜

> IP 주소를 이용해 MAC 주소를 알아오는 ARP 프로토콜
>
> 4장에서 다룰 예정

#### IPv4 프로토콜

> WAN에서 통신할 때 사용
>
> IPv6도 존재(모양과 주소 자체가 다름) ===> IPv4와는 별개로 생각하기

![image-20210930235917740](assets/image-20210930235917740.png)

#### ICMP 프로토콜

> 서로가 통신되는지 확인할 때 사용

![image-20211001000029979](assets/image-20211001000029979.png)



## 일반적인 IP 주소

### classful

<img src="assets/image-20211001000139188.png" alt="image-20211001000139188" style="zoom:80%;" />

- IPv4가 처음에 등장했을 때 classful하게 나눠서 사용
- 클래스에 맞게, 사용할 수 있는 범위를 지정해서 사용
- 낭비가 심함
- 클래스로 나눴던 이유
  - 클래스 첫번째 필드: 네트워크 대역을 구분하는데 사용 && 뒤에는 그 네트워크 대역에 포함되는 컴퓨터의 개수(ex. A의 네트워크 대역은 0부터 127까지 128개, 컴퓨터의 수는 2^24)
  - D 클래스는 멀티캐스트를 위한 주소
  - E 클래스는 네트워크 연구를 위한 주소
- 클래스로 사용할 시 하나의 네트워크를 할당했을 때 네트워크 장비(컴퓨터)의 낭비가 심했음(낭비를 없애려면 한 사업장안에 2^24개의 네트워크 장비를 설치해야함) => 컴퓨터의 발전으로 IP주소는 부족해지짐 => classless한 주소를 사용하자

<img src="assets/image-20211001001407057.png" alt="image-20211001001407057" style="zoom:77%;" />

- 1byte == 8 bit
- IPv4 주소는 십진수 네자리로 표현된 것 => 각각의 자리를 이진수로 표현가능한 숫자만큼 밖에쓰지 못함(최대 255까지) => 0~255까지 사용 가능
- 이 범위를 각각 클래스로 나누서 사용

<img src="assets/image-20211001010227986.png" alt="image-20211001010227986" style="zoom:67%;" />



### classfulless

- 하나의 네트워크를 잘라서 사용

![image-20211001011238196](assets/image-20211001011238196.png)

- classful하게 네트워크를 사용했더니 IP 주소 부족(.단위로 네트워크 대역 구분) => 서브넷 마스크로 구분
- 서브넷 마스크: 네트워크 대역을 어디서부터 지정할 것인지를 알려줌

<img src="assets/image-20211001011430579.png" alt="image-20211001011430579" style="zoom:80%;" />

- 1까지가 네트워크 대역을 구분하는 값
- 낭비되는 IP가 줄어듬

#### ==서브넷팅 vs. 슈퍼넷팅==

- 서브넷팅은 주어진 네트워크 주소를 작게 나눈 것
- 서브넷팅의 반대말로 네트워크를 합치는 작업



### 사설 IP와 공인 IP

![image-20211013233245067](assets/image-20211013233245067.png)

- IPv4 사용으로 인한 부족함에 대한 해결책
- 공인IP 1개당 2^32개의 사설 IP

#### 공인IP

- 실제 네트워크 통신망과 통신할 때 사용하는 IP 주소(외부 세상)

#### 사설IP

- 같은 네트워크 대역에서 사용하는 IP 주소(파란 부분 내)
- 만일 모바일 기기 A에서 네이버에 요청을 보내면 공인 IP 주소 바껴서 요청을 보내고, 받아온 응답은 공유기에 전달되어 공유기가 모바일 기기 A에게 전달함

#### NAT(Network address translation)

- 네트워크 주소를 사설 IP에서 공인 IP로 바꿔주는 것 => 정확하게 말하면 특정 IP를 특정 IP로 변환하는 것
- 나갈 때(요청을 보낼 때) 테이블에 기록 => 응답이 왔을 때 이를 통해 그 대상한테 전달
- 만일, 나간적이 없는 패킷이 응답으로 들어온다면 공유기가 받고 끝남
- 서버의 경우 요청을 받는 주체로서 위처럼 행동하면 안되기에 ==**서버는 사설 IP를 사용 X**==

<img src="assets/image-20211013234907459.png" alt="image-20211013234907459" style="zoom:67%;" />

- 외부에서는 사설 네트워크(사설 IP)가 존재하지 않는 것처럼 보인다.



## 특수한 IP 주소 

### 0.0.0.0

<img src="assets/image-20211013235830442.png" alt="image-20211013235830442" style="zoom:80%;" />

- ==**나머지**== 모든 IP(wildcard)
- 컴퓨터에 일반적으로 사용하지 X



### 127.X.X.X

<img src="assets/image-20211013235914970.png" alt="image-20211013235914970" style="zoom:80%;" />

- 자기 자신을 나타내는 주소



### 게이트웨이 주소

![image-20211014000019952](assets/image-20211014000019952.png)

- 어딘가로 가려면 일단 여기로
- 외부 세상으로 나가는 문
- 기본 게이트웨이 == 공유기IP

![image-20211014000344234](assets/image-20211014000344234.png)

- wan은 외부에서 들어오는 인터넷선(공인 IP)/오른쪽은 사설 IP 

