# 4계층 v2

## 🍟UDP (User Datagram Protocol) 프로토콜

- 전송 방식이 너무 단순해서 서비스의 신뢰성이 낮다.
- 뎅터그램 도착 순서가 바뀌거나 중복,  누락되기도 한다.
- 일반적으로 오류의 검사와 수정이 필요 없는 프로그램에서 수행할 것으로 가정한다.



#### 🥓UDP 구조

![UDP 구조](img/4%EA%B3%84%EC%B8%B5/UDP%20%EA%B5%AC%EC%A1%B0.png)





### 🥓어떤 프로그램이 UDP프로토콜을 사용할까?

- **DNS 서버**

  - 도메인을 물어보면 IP를 알려준다.

    `www.naver.com`을 입력하게 되면, 이 도메인 주소의 ip주소를 알려주는 것이 DNS서버이다. 이 때 UDP 프로토콜을 사용해서 알려주게 된다.

    ![DNS서버](img/4%EA%B3%84%EC%B8%B5/DNS%EC%84%9C%EB%B2%84.PNG)



- **tftp 서버**
  - 파일전송 프로그램
  - UDP로 파일을 공유한다.



- **RIP 프로토콜**
  - 라우팅 정보를 공유한다.



## 🍟TCP (Transmission Control Protocol) 프로토콜

- 연결된 컴퓨터에서 실행되는 프로그램 간에 통신을 안정적으로, 순서대로, 에러없이 교환할 수 있게 한다.
- UDP보다 안전하지만 느리다.



#### 🥓 TCP 구조

![TCP 구조](img/4%EA%B3%84%EC%B8%B5/TCP%20%EA%B5%AC%EC%A1%B0.PNG)

- offset: 헤더 길이를 의미한다.
- reserved: 예약된 필드로 사용하지 않는 필드
- Window: 데이터를 얼마만큼 더 보내도 되는지 알려준다.
- TCP Flags: 패킷의 상태를 알려준다.
  - U(urgent): 긴급비트. 우선순위가 높은 데이터가 포함되어있음을 알려준다.
  - A(ack): 승인비트. TCP 통신을 할 때 승인을 표현한다.
  - P(push): 계속해서 데이터를 밀어 넣을 때 사용한다.
  - R(reset): 초기화비트. 연결이 되어있는 상태에서 문제가 발생한 경우 초기화가 필요한 경우 사용한다.
  - s(sync): 동기화 비트. 상대방과 연결을 시작할 때 무조건 사용하는 플래그이다.
  - F(finish): 연결을 끊을 때 사용하는 플래그이다.



## 🍔TCP 통신 과정

### 3Way Handshake

- 클라이언트가 서버에게 요청 패킷을 보낸다.

  ![출발](img/4%EA%B3%84%EC%B8%B5/%EC%B6%9C%EB%B0%9C.png)

- 서버가 클라이언트의 요청을 받아들이는 패킷 보낸다.

  ![응답](img/4%EA%B3%84%EC%B8%B5/%EC%9D%91%EB%8B%B5.png)

- 클라이언트는 이를 최종적으로 수락하는 패킷을 보낸다.

  ![재요청](img/4%EA%B3%84%EC%B8%B5/%EC%9E%AC%EC%9A%94%EC%B2%AD.png)

  ![마무리](img/4%EA%B3%84%EC%B8%B5/%EB%A7%88%EB%AC%B4%EB%A6%AC.png)

