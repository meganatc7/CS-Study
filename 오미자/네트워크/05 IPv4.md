# 💨멀리 있는 곳은 어떻게 통신할까? (3계층)

## 🤓 IPv4

- 네트워크 상에서 데이터를 교환하기 위한 프로토콜
- 데이터가 정확하게 전달될 것을 보장하지 않음(중간에 누락될 가능성도 있음)
  - 정확하고 순차적인 전달은 상위프로토콜인 TP에서 보장한다.



### 구조

- **Version**: 4 (IPv6랑은 구조 자체가 다름) (4 bit)
- **IHL**(헤더 길이: 20바이트~ 60바이트) : 4bit로 표현/ 4로 나눈 값을 입력함
- **TOS**(type of service): 요즘에는 사용하지 않음. 0으로 비워둠. (8bit)
- **Total** Length: 상위계층에서부터 인캡슐레이션 해서 내려온 데이터의 전체 길이 (16bit)
- **Identification**: 쪼개진 데이터들을 알아볼 수 있도록 해주는 식별자(쪼개진 패킷마다 값이 같음 -> 16bit)
- **IP Flags**: X(NO), D(Done - 데이터를 쪼개지 않고 보내겠다.), M(More - 패킷이 조각화되어 있는 경우 뒤에 패킷이 더 있음을 나타냄) (3비트bit
- **Fragment** **Offset**: 데이터가 전달되면서 중간에 다른 데이터랑도 섞이면서 순서가 바뀔 수 있음 -> 쪼개진 패킷들의 순서를 알려줌. (13bit)
- **TTL**(Time To Live): 네트워크 대역에 존재할 수 있는 패킷의 시간(?) - 계속 남아있으면 다른 통신에 영향을 줄 수 있기 때문에 수명이 필요함(8 bit)
- **Protocol**: 상위 프로토콜이 뭔지 알려줌(8 bit)
- **Header** **Checksum:** 이 헤더가 오류가 있는지 없는지 확인(16 bit)





## 🤓 ICMP 프로토콜

네트워크 컴퓨터 위에서 돌아가는 운영체제에서 오류 메시지를 전송받는데 주로 쓰임

`Type`과 `Code`를 통해 오류 메시지를 전송 받음.



### 구조

- Type: **대분류**

  - `0 Echo Reply` -> 응답

  - `8 Echo` -> 요청

  - `3 Destination Unreachable` -> 목적지에 도달하지 못함 (가는 경로에 문제 발생)

  - `11 Time Exceded ` -> 요청 시간이 만료되었음(목적지까지는 갔지만 문제 발생)

    (ex) 방화벽

  - `5 Redirect`

- Code: **소분류**