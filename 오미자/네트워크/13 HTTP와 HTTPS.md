# HTTP와 HTTPS

## HTTP란?

HTML 문서와 같은 리소스들을 가져올 수 있도록 해주는 프로토콜

`프로토콜`: 컴퓨터 내부 or 컴퓨터 상에서 데이터 교환 방식을 정의하는 규칙 체계



## HTTP 문제점

- **HTTP는 평문 통신이기 때문에 중간에서 도청이 가능하다.**

  TCP/IP 구조의 통신은 모두 통신 경로 상에서 엿볼 수 있다. 패킷을 수집하는 것만으로 도청할 수 있다. 따라서 암호화하여 통신해야 한다.

  - 통신 자체를 암호화(SSL or TLS) 라는 다른 프로토콜을 조합함으로써 HTTP 통신 내용을 암호화할 수 있다.
  - 콘텐츠를 암호화 말 그대로 HTTP를 사용해서 운반하는 내용인 콘첸츠만 암호화하는 것이다. 암호화해서 전송하면 받은 측에서는 그 암호를 해독하여 출력하는 처리가 필요하다.

- **통신 상대를 확인하지 않기 때문에 위장이 가능하다.**

  HTTP 에 의한 통신에는 상대가 누구인지 확인하는 처리가 없기 때문에 누구든지 request를 보낼 수 있다. IP 주소나 포트 등에서 그 웹 서버에 엑세스 제한이 없는 경우 request가 오면 상대가 누구든지 response를 반환한다. -> 의미없는 request도 수신 가능하다 -> DoS 공격을 방지할 수 없다.

  - `SSL`로 상대를 확인할 수 있다. SSL은 상대를 확인하는 수단으로 증명서를 제공하고 있는데, 이 증명서는 신뢰할 수 있는 제 3자 기관에 의해 발행되는 것이기 때문에 서버나 클라이언트가 실재하는 사실을 증명한다.

- **완전성을 증명할 수 없기 때문에 변조가 가능하다.**

  완전성 == 정보의 정확성

  서버 또는 클라이언트에서 수신한 내용이 송신측에서 보낸 내용과 일치한다라는 것을 보장할 수 없다. request나 respose가 발신된 후에 상대가 수신하는 사이에 누군가에 의해 변조되더라도 이 사실을 알 수 없다.

  - HTTPS를 사용해야 한다.





## HTTPS - HTTP Secure

- SSL 껍질을 덮어 쓴 HTTP

- 클라이언트와 서버 간의 모든 커퓨니케이션을 암호화 하기 위해 `SSL` 이나 `TLS`를 사용하여서 민감한 정보를 안전하게 주고받도록 해준다. (ex: 금융관련, 온라인 쇼핑 등)
- HTTP는 원래 TCP와 직접 통신했지만, HTTPS에서 HTTP는 SSL과 통신하고 SSL이 TCP와 통신하게 된다. SSL을 사용한 HTTPS는 암호화와 증명서, 안전성 보호를 이용할 수 있다.



### SSL

- Secure Socket Layer

- 사용자가 사이트에 제공하는 정보를 암호화해서 누군가가 해독할 수 없도록 해준다.

### TLS

- Transport Layer Security
- 데이터 무결성을 제공하기 때문에 데이터가 전송 중에 수정되거나 손상되는 것을 방지한다.
- 사용자가 자신이 의도하는 웹사이트와 통신하고 있음을 입증하는 인증 기능도 제공한다.



### HTTPS 암호화 전송 이해를 위한 개념

- 암호화: 어떤 정보를 암호화된 정보로 바꾸는 것
- 복호화: 암호화된 정보를 다시 원래 정보로 바꾸는 것
- 키: 암호화, 복호화 할 때 쓰는 비밀번호
- HTTPS는 공통 키 방식과 비대칭 키 방식을 같이 사용한다.



### 공통 키 방식 vs 비대칭 키 방식

- 공통 키 방식
  - 암호화 할 때와 복호화 할 때 같은 키를 사용하는 방식
  - 장점: 단순한 구조이기 때문에 CPU를 적게 쓰고 빠르다.
  - 단점: 공통 키를 빼앗기면 복호화 할 수 있으므로 보완에 취약하다.
- 비대칭 키 방식
  - 암호화 할 때와 복호화 할 때 다른 키를 사용하는 방식
  - 클라이언트는 공통 키를, 서버는 인증서와 공개 키를 제공하며 클라이언트는 서버가 제공한 공개 키를 통해 공통 키를 암호화하여서 서버에게 전송한다. 서버는 수신한 HTTPS 인증서와 공개 키 일치를 바탕으로 공통 키를 복호해 요청에 대응한다.
  - 장점: 키 전송과정 중 빼앗겨도 해독할 수 없기 때문에 공통 키 방식보다 안전하다.
  - 단점: 공통 키 방식보다 느리고 리소스 소비가 크다.



### HTTPS는 공통 키 방식과 비대칭 키 방식을 같이 사용한다.

- 비대칭 키 방식이 가진 이점은 이어가되 전송 소요시간 및 리소스 부담은 줄이는 방식
- HTTPS를 통한 통신이 시작될 때 서버는 서버가 제공한 공개 키와 증명서에 부합하는 요청을 클라이언트가 보냈는지 확인한다. 클라이언트가 공통 키를 서버가 제공한 공개 키로 암호화해 서버에게 보낸 첫 번째 요청을 복호화하는 과정(핸드쉐이크)이 끝나면 실제 요청과 정보를 교환하는 과정이 이어진다.
- 서버가 제공하는 공개 키(비대칭 키)를 써 클라이언트는 서버에게 보낼 공통 키를 암호화한다.
- 서버는 클라이언트가 보낸 암호화된 요청을 공개 키(비대칭 키) 로 복호화한다.
- 결과적으로 클라이언트와 서버는 서버가 제공한 공개 키를 통해 암호화된 공통 키로 통신한다.